---
import Layout from '../../../layouts/Layout.astro';
---

<Layout title="ã‚¹ã‚¿ã‚¤ãƒ«ä»˜ããƒ†ã‚­ã‚¹ãƒˆç½®æ› - hrã®å‚™å¿˜éŒ²" description="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰å†…ã®æ›¸å¼ï¼ˆå¤ªå­—ãƒ»è‰²ãªã©ï¼‰ã‚’ç¶­æŒã—ãŸã¾ã¾æ–‡å­—åˆ—ã‚’ç½®æ›ã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã€‚Word ã‚„ Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ä¾¿åˆ©ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å®Œçµã€ãƒ‡ãƒ¼ã‚¿é€ä¿¡ãªã—ã€‚">
  <main>
    <header class="article-header">
      <a href="/tools" class="back-link">â† ãƒ„ãƒ¼ãƒ«ä¸€è¦§</a>
      <h1>ã‚¹ã‚¿ã‚¤ãƒ«ä»˜ããƒ†ã‚­ã‚¹ãƒˆç½®æ›</h1>
    </header>

    <article class="article-body">
      <p>
        Word ã‚„ Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€Notion ãªã©ã‹ã‚‰ã‚³ãƒ”ãƒ¼ã—ãŸ<strong>æ›¸å¼ä»˜ããƒ†ã‚­ã‚¹ãƒˆ</strong>ã‚’ã€
        ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆå¤ªå­—ãƒ»è‰²ãƒ»ã‚µã‚¤ã‚ºãªã©ï¼‰ã‚’ç¶­æŒã—ãŸã¾ã¾ç½®æ›ã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã€‚
      </p>

      <div class="tool-container">
        <section class="tool-section">
          <h2>1. ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰èª­ã¿è¾¼ã¿</h2>
          <button id="loadBtn" class="primary-btn">ğŸ“‹ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰èª­ã¿è¾¼ã‚€</button>
          <p class="note">â€» åˆå›ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰è¨±å¯ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™</p>
        </section>

        <section class="tool-section">
          <h2>2. ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆèª­ã¿è¾¼ã¿å¾Œï¼‰</h2>
          <div id="preview" class="preview-box" contenteditable="false">
            ã“ã“ã«èª­ã¿è¾¼ã‚“ã ãƒ†ã‚­ã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™
          </div>
        </section>

        <section class="tool-section">
          <h2>3. ç½®æ›è¨­å®š</h2>
          <div class="input-group">
            <label for="searchText">ç½®æ›å‰ã®æ–‡å­—åˆ—:</label>
            <input type="text" id="searchText" placeholder="ä¾‹: ä¼šç¤¾å" />
          </div>
          <div class="input-group">
            <label for="replaceText">ç½®æ›å¾Œã®æ–‡å­—åˆ—:</label>
            <input type="text" id="replaceText" placeholder="ä¾‹: çµ„ç¹”å" />
          </div>
          <div class="checkbox-group">
            <label>
              <input type="checkbox" id="useRegex" />
              æ­£è¦è¡¨ç¾ã‚’ä½¿ç”¨ã™ã‚‹
            </label>
          </div>
          <div class="checkbox-group">
            <label>
              <input type="checkbox" id="caseSensitive" />
              å¤§æ–‡å­—ãƒ»å°æ–‡å­—ã‚’åŒºåˆ¥ã™ã‚‹
            </label>
          </div>
          <button id="replaceBtn" class="primary-btn">ğŸ”„ ç½®æ›ã‚’å®Ÿè¡Œ</button>
        </section>

        <section class="tool-section">
          <h2>4. ç½®æ›çµæœ</h2>
          <div id="result" class="preview-box" contenteditable="false">
            ç½®æ›å¾Œã®ãƒ†ã‚­ã‚¹ãƒˆãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™
          </div>
          <button id="copyBtn" class="primary-btn" disabled>ğŸ“‹ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼</button>
          <p id="copyStatus" class="status-message"></p>
        </section>
      </div>

      <section class="usage-section">
        <h2>ä½¿ã„æ–¹</h2>
        <ol>
          <li>Word ã‚„ Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãªã©ã§<strong>æ›¸å¼ä»˜ããƒ†ã‚­ã‚¹ãƒˆ</strong>ã‚’ã‚³ãƒ”ãƒ¼</li>
          <li>ã“ã®ãƒšãƒ¼ã‚¸ã§ã€Œã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰èª­ã¿è¾¼ã‚€ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
          <li>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§å†…å®¹ã¨ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ç¢ºèª</li>
          <li>ç½®æ›å‰ãƒ»ç½®æ›å¾Œã®æ–‡å­—åˆ—ã‚’å…¥åŠ›</li>
          <li>ã€Œç½®æ›ã‚’å®Ÿè¡Œã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
          <li>çµæœã‚’ç¢ºèªã—ã¦ã€Œã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã€</li>
          <li>å…ƒã®æ–‡æ›¸ã«è²¼ã‚Šä»˜ã‘ï¼ˆCtrl+V / Cmd+Vï¼‰</li>
        </ol>
      </section>

      <section class="usage-section">
        <h2>ã“ã‚“ãªæ™‚ã«ä¾¿åˆ©</h2>
        <ul>
          <li>æ›¸å¼è¨­å®šã—ãŸé•·æ–‡ã®ä¸­ã§ç‰¹å®šã®å˜èªã‚’ä¸€æ‹¬ç½®æ›ã—ãŸã„</li>
          <li>å¤ªå­—ã‚„è‰²ä»˜ãã®æ–‡å­—ã‚’å«ã‚€æ–‡æ›¸ã§ç”¨èªã‚’çµ±ä¸€ã—ãŸã„</li>
          <li>ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å´©ã•ãšã«ä¼šç¤¾åã‚„è£½å“åã‚’å¤‰æ›´ã—ãŸã„</li>
        </ul>
      </section>

      <section class="usage-section">
        <h2>æ³¨æ„äº‹é …</h2>
        <ul>
          <li>ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å‹•ä½œã—ã€ãƒ‡ãƒ¼ã‚¿ã¯ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã¾ã›ã‚“</li>
          <li>è¤‡é›‘ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆè¡¨ã€ç”»åƒãªã©ï¼‰ã¯æ­£ã—ãå‡¦ç†ã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™</li>
          <li>Chromeã€Edgeã€Safari ãªã©ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®ä½¿ç”¨ã‚’æ¨å¥¨</li>
        </ul>
      </section>
    </article>
  </main>
</Layout>

<script>
  let loadedHtml = '';
  let replacedHtml = '';

  const loadBtn = document.getElementById('loadBtn') as HTMLButtonElement;
  const replaceBtn = document.getElementById('replaceBtn') as HTMLButtonElement;
  const copyBtn = document.getElementById('copyBtn') as HTMLButtonElement;
  const preview = document.getElementById('preview') as HTMLDivElement;
  const result = document.getElementById('result') as HTMLDivElement;
  const searchText = document.getElementById('searchText') as HTMLInputElement;
  const replaceText = document.getElementById('replaceText') as HTMLInputElement;
  const useRegex = document.getElementById('useRegex') as HTMLInputElement;
  const caseSensitive = document.getElementById('caseSensitive') as HTMLInputElement;
  const copyStatus = document.getElementById('copyStatus') as HTMLParagraphElement;

  // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰èª­ã¿è¾¼ã¿
  loadBtn.addEventListener('click', async () => {
    try {
      const clipboardItems = await navigator.clipboard.read();
      for (const item of clipboardItems) {
        if (item.types.includes('text/html')) {
          const blob = await item.getType('text/html');
          const html = await blob.text();
          loadedHtml = html;
          preview.innerHTML = html;
          preview.style.color = '#333';
          break;
        } else if (item.types.includes('text/plain')) {
          const blob = await item.getType('text/plain');
          const text = await blob.text();
          loadedHtml = text;
          preview.textContent = text;
          preview.style.color = '#333';
          break;
        }
      }
    } catch (err) {
      alert('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\nãƒ–ãƒ©ã‚¦ã‚¶ã®æ¨©é™è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
      console.error(err);
    }
  });

  // ç½®æ›å®Ÿè¡Œ
  replaceBtn.addEventListener('click', () => {
    const search = searchText.value;
    const replace = replaceText.value;

    if (!search) {
      alert('ç½®æ›å‰ã®æ–‡å­—åˆ—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
      return;
    }

    if (!loadedHtml) {
      alert('ã¾ãšã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„');
      return;
    }

    try {
      // ä¸€æ™‚çš„ãªDOMè¦ç´ ã‚’ä½œæˆ
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = loadedHtml;

      // ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã‚’èµ°æŸ»ã—ã¦ç½®æ›
      replaceTextInNode(tempDiv, search, replace);

      replacedHtml = tempDiv.innerHTML;
      result.innerHTML = replacedHtml;
      result.style.color = '#333';
      copyBtn.disabled = false;
      copyStatus.textContent = '';
    } catch (err) {
      alert('ç½®æ›å‡¦ç†ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
      console.error(err);
    }
  });

  // ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã‚’å†å¸°çš„ã«èµ°æŸ»ã—ã¦ç½®æ›
  function replaceTextInNode(node: Node, search: string, replace: string) {
    if (node.nodeType === Node.TEXT_NODE) {
      // ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã®å ´åˆ
      if (node.textContent) {
        if (useRegex.checked) {
          const flags = caseSensitive.checked ? 'g' : 'gi';
          const regex = new RegExp(search, flags);
          node.textContent = node.textContent.replace(regex, replace);
        } else {
          const flags = caseSensitive.checked ? 'g' : 'gi';
          const regex = new RegExp(escapeRegExp(search), flags);
          node.textContent = node.textContent.replace(regex, replace);
        }
      }
    } else if (node.nodeType === Node.ELEMENT_NODE) {
      // è¦ç´ ãƒãƒ¼ãƒ‰ã®å ´åˆã€å­ãƒãƒ¼ãƒ‰ã‚’å†å¸°çš„ã«å‡¦ç†
      for (let i = 0; i < node.childNodes.length; i++) {
        replaceTextInNode(node.childNodes[i], search, replace);
      }
    }
  }

  // æ­£è¦è¡¨ç¾ã®ç‰¹æ®Šæ–‡å­—ã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
  function escapeRegExp(string: string) {
    return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  }

  // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
  copyBtn.addEventListener('click', async () => {
    try {
      const blob = new Blob([replacedHtml], { type: 'text/html' });
      const plainText = result.textContent || '';
      const textBlob = new Blob([plainText], { type: 'text/plain' });
      
      await navigator.clipboard.write([
        new ClipboardItem({
          'text/html': blob,
          'text/plain': textBlob
        })
      ]);
      
      copyStatus.textContent = 'âœ… ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼';
      copyStatus.style.color = '#28a745';
      
      setTimeout(() => {
        copyStatus.textContent = '';
      }, 3000);
    } catch (err) {
      alert('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸ã®ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ');
      console.error(err);
    }
  });
</script>

<style>
  main {
    max-width: 900px;
    margin: 0 auto;
    padding: 2rem 1rem;
    line-height: 1.7;
  }

  .article-header {
    margin-bottom: 2rem;
  }

  .back-link {
    display: inline-block;
    margin-bottom: 1rem;
    font-size: 0.9rem;
    color: #667eea;
    text-decoration: none;
  }

  .back-link:hover {
    text-decoration: underline;
  }

  h1 {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .article-body {
    color: #444;
  }

  .article-body h2 {
    font-size: 1.5rem;
    margin-top: 2rem;
    margin-bottom: 0.75rem;
    color: #333;
    border-bottom: 1px solid #e0e0e0;
    padding-bottom: 0.25rem;
  }

  .article-body p, .article-body ul, .article-body ol {
    margin-bottom: 1rem;
    color: #444;
  }

  .article-body li {
    margin-bottom: 0.5rem;
  }

  .tool-container {
    background: #f8f9fa;
    padding: 2rem;
    border-radius: 8px;
    margin: 2rem 0;
  }

  .tool-section {
    margin-bottom: 2rem;
  }

  .tool-section:last-child {
    margin-bottom: 0;
  }

  .tool-section h2 {
    font-size: 1.2rem !important;
    margin-top: 0 !important;
    margin-bottom: 1rem !important;
    color: #555 !important;
    border: none !important;
    padding-bottom: 0 !important;
  }

  .preview-box {
    min-height: 120px;
    padding: 1rem;
    background: white;
    border: 2px solid #ddd;
    border-radius: 6px;
    margin-bottom: 1rem;
    overflow-y: auto;
    max-height: 300px;
    color: #999;
    font-style: italic;
  }

  .input-group {
    margin-bottom: 1rem;
  }

  .input-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
    color: #333;
  }

  .input-group input[type="text"] {
    width: 100%;
    padding: 0.75rem;
    border: 2px solid #ddd;
    border-radius: 6px;
    font-size: 1rem;
    box-sizing: border-box;
  }

  .input-group input[type="text"]:focus {
    outline: none;
    border-color: #667eea;
  }

  .checkbox-group {
    margin-bottom: 1rem;
  }

  .checkbox-group label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    color: #333;
  }

  .checkbox-group input[type="checkbox"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
  }

  .primary-btn {
    padding: 0.75rem 1.5rem;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .primary-btn:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
  }

  .primary-btn:active:not(:disabled) {
    transform: translateY(0);
  }

  .primary-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .note {
    font-size: 0.85rem;
    color: #666;
    margin-top: 0.5rem;
  }

  .status-message {
    margin-top: 0.5rem;
    font-weight: 500;
  }

  .usage-section {
    margin-top: 2rem;
  }

  .usage-section h2 {
    font-size: 1.3rem;
    margin-bottom: 1rem;
    color: #333;
  }

  .usage-section ol, .usage-section ul {
    padding-left: 2rem;
  }

  .usage-section li {
    margin-bottom: 0.5rem;
  }

  @media (max-width: 768px) {
    .tool-container {
      padding: 1rem;
    }
  }
</style>
